var addressShip="";function deleteCode(a){for(var e=$("#CodesApply").val().split(","),t="",d=0;d<e.length-1;d++)d!=a&&""!=e[d]&&(t=t+e[d]+",");$("#CodesApply").val(t),$(".animationloadpage").show(),$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$.ajax({type:"POST",url:"deleteCode",dataType:"text",data:{codes:$("#CodesApply").val(),ward:addressShip},success:function(a){if(0!=a){$("#pricecheckCoded").html(a);var e=$("#CodesApply").val().split(",");$("#dscode").html("");for(var t=0;t<e.length-1;t++)$("#dscode").html($("#dscode").html()+'<span class="btn btn-info px-2 py-2 rounded mr-2">'+e[t]+'<div class="deleteCode" id="'+e[t]+'" onclick="deleteCode('+t+')"><i class="fa fa-times-circle" aria-hidden="true"></i></div></span>')}$(".animationloadpage").hide()}})}$(".deleteCode").on("click",function(){}),$("#checkCode").on("click",function(){if(""==$("#code").val()||" "==$("#code").val())return $(".alertAjax").hasClass("alert-warning")||$(".alertAjax").addClass("alert-warning"),$(".alertAjax .content").html("Không được để trống"),$(".alertAjax").show(),void $(".alert").delay(5e3).fadeOut();var a=$("#CodesApply").val().split(",");if(a.length>1)for(var e=0;e<a.length;e++)if(a[e]==$("#code").val())return $(".alertAjax").hasClass("alert-warning")||$(".alertAjax").addClass("alert-warning"),$(".alertAjax .content").html("Mã này đã được áp dụng!"),$(".alertAjax").show(),void $(".alert").delay(5e3).fadeOut();$(".animationloadpage").show(),$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$.ajax({type:"POST",url:"checkCode",dataType:"text",data:{name:$("#code").val(),codes:$("#CodesApply").val(),ward:addressShip},success:function(a){if(0!=a){$("#pricecheckCoded").html(a),-1!=a.indexOf("daylacodetoandonhang")?$("#CodesApply").val($("#code").val()+","):$("#CodesApply").val($("#CodesApply").val()+$("#code").val()+",");var e=$("#CodesApply").val().split(",");$("#dscode").html("");for(var t=0;t<e.length-1;t++)$("#dscode").html($("#dscode").html()+'<span class="btn btn-info px-2 py-2 rounded mr-2">'+e[t]+'<div class="deleteCode" id="'+e[t]+'" onclick="deleteCode('+t+')"><i class="fa fa-times-circle" aria-hidden="true"></i></div></span>')}else $(".alertAjax").hasClass("alert-warning")||$(".alertAjax").addClass("alert-warning"),$(".alertAjax .content").html("Mã không khả dụng"),$(".alertAjax").show(),$(".alert").delay(5e3).fadeOut();$(".animationloadpage").hide()}})}),$("#state").on("change",function(){$(".animationloadpage").show(),$.ajax("/district/load/"+$("#state").val(),{method:"GET",dataType:"JSON",contentType:!1,cache:!1,processData:!1,success:function(a){if(a.success){$("#district").html(""),$("#ward").html("");var e="<option></option>";$("#district").append($(e).attr("value",0).text("---Chọn quận/huyện---")),$.each(a.data,function(a,t){var d=t.district_id;$("#district").append($(e).attr("value",t.district_id).attr(d?"selected":"data-id",d?"selected":t.district_id).text(t.name))})}$("#district").val("0"),$(".animationloadpage").hide()}})}),$("#district").on("change",function(){$(".animationloadpage").show(),$.ajax("/ward/load/"+$("#district").val(),{method:"GET",dataType:"JSON",contentType:!1,cache:!1,processData:!1,success:function(a){if(a.success){$("#ward").html("");var e="<option></option>";$("#ward").append($(e).attr("value",0).text("---Chọn phường/xã---")),$.each(a.data,function(a,t){var d=t.ward_id;$("#ward").append($(e).attr("value",t.ward_id).attr(d?"selected":"data-id",d?"selected":t.ward_id).text(t.name))})}$("#ward").val("0"),$(".animationloadpage").hide()}})}),$("#ward").on("input",function(){addressShip=$("#ward").val(),$(".animationloadpage").show(),$.ajax("/shipPing/"+addressShip,{method:"GET",dataType:"JSON",contentType:!1,cache:!1,processData:!1,success:function(a){$('.countShipTd').css('opacity','1');var e=$(".countShip").html();e=""==e?0:e.replace(",",""),$(".countShip").html(a.shipPing.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"));var t=$(".countTotal").html();t=t.split(",").join(""),priceEnd=Number(t)+Number(a.shipPing)-Number(e),$(".countTotal").html(priceEnd.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")),$(".animationloadpage").hide()}})}),$(".WardLast").on("click",function(){id=$(this).attr("id"),addressShip=id,$.ajax("/shipPing/"+id,{method:"GET",dataType:"JSON",contentType:!1,cache:!1,processData:!1,success:function(a){$('.countShipTd').css('opacity','1');var e=$(".countShip").html();e=""==e?0:e.replace(",",""),$(".countShip").html(a.shipPing.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"));var t=$(".countTotal").html();t=t.split(",").join(""),priceEnd=Number(t)+Number(a.shipPing)-Number(e),$(".countTotal").html(priceEnd.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"))}})}),$(".tabAddressOrder").on("click",function(){id=$(this).attr("id"),"newtab"==id?($("#addressOrderNew").show(),$("#addressOrderLast").hide()):($("#addressOrderNew").hide(),$("#addressOrderLast").show()),$(".tabAddressOrder").removeClass("text-danger"),$(this).addClass("text-danger")}),$(".WardLast").on("click",function(){$("#phone").val("")}),$("#place_order").on("click",function(){$(".animationloadpage").show(100).delay(2e3).hide(100)});